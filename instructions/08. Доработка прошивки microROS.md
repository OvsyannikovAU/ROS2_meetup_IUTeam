
Пример прошивки microROS pi pico, который устанавливается по инструкции из официального репозитория, просто отправляет новое число каждую секунду. Ранее мы уже описывали тестовый скетч для проверки отправки и получения сообщений (просто мигание светодиодом на входящие сообщения). Мобильному роботу требуется не просто мигать, но согласно полученным сообщениям крутить моторы, считать положение и ориентацию робота по показаниям энкодеров и т.д. Для этого требуется написать взаимодействие с драйверами моторов (цифровые сигналы и ШИМ), энкодерами (прерывания) и датчиками (аналоговые сигналы, I2C и т.д.).

Как результат нами были подготовлены файлы ...

В них требуется указать геометрические параметры робота:
- диаметр колес...
- расстояние между колесами (колея робота)...
- количество тиков энкодера на один оборото вала мотора...
- передаточное отношение редуктора между мотором и валом колеса...

Как и ранее, собираем программу с помощью
```
cmake ..
make
```
и загружаем на RPi pico командой
```
cp ~/micro_ros_raspberrypi_pico_sdk/build/pico_micro_ros_hackathon.uf2 /media/$USER/RPI-RP2
```

Если у программы менялось имя (например, вместо pico_micro_ros_hackathon или pico_micro_ros_example на pico_micro_ros_robot), то требуется предварительно изменить файл CMakeList.txt, указав актуальные названия проектов и файлов во всех секциях кода. И в команде копирования тоже требуется изменить имя скомпилированного файла .uf2.

Для проверки можно попробовать поуправлять роботом с клавиатуры, для этого запускаем в консоли:
```
ros2 run teleop_twist_keyboard teleop_twist_keyboard
```

Наша прошивка microROS для rpi pico принимает параметры ПИД-регулятора, управляющие воздействия в виде двух величин (линейная и угловая скорости), возвращает положение робота и логи. Для чтения логов можно использовать считывание топика rosout консольной командой
```
ros2 topic echo /rosout
```
либо настроить контексты ROS2 и microROS
```
source ~/micro_ros_ws/src/install/setup.bash
source /opt/ros/jazzy/setup.bash
```
и запустить приложение rqt командой
```
ros2 run rqt_console rqt_console
```